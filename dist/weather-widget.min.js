/*
 * jQuery Weather Widget
 * 2016 Matt O'Connell <mattoconnell408@gmail.com> 
 * License: MIT
 */
 
!function(a,b){"use strict";var c=function(b,c){var e=this;e.$el=a(b).addClass("weather-widget"),e.defaults=d,e.init=function(){e.pollAPI(c,e.makeWidget)},e.defaults.geoLocate&&"undefined"!=typeof geoLite&&"object"==typeof geoLite&&!geoLite.wait?(document.body.addEventListener("onLocateSuccess",function(){var b={lat:geoLite.lat,lon:geoLite.lon};c=a.extend(c,b),e.init()}),document.body.addEventListener("onLocateFail",function(){e.init()})):e.init()},d={lat:"40.748441",lon:"-73.985793",url:"https://api.forecast.io/forecast/",key:null,cacheTime:30,geoLocate:!0,celsius:!1,imgPath:"bower_components/weather-widget/dist/img/",showTitle:!0,localeDetect:!1},e=function(a){return Math.round(5*(a-32)/9)};c.prototype.makeURL=function(a){return a.url+a.key+"/"+a.lat+","+a.lon},c.prototype.pollAPI=function(c,e){c=a.extend(d,c);var f=this,g=f.makeURL(c),h=b?b.get(g,c.cacheTime):!1;return f.options=c,h?(e.call(f,h),!1):void a.ajax({dataType:"jsonp",url:g,success:function(a){b&&b.set(g,a);try{e&&e.call(f,a)}catch(c){f.$el.hide(),console.log("Error: ",c)}},error:function(a){console.log(a)}})};var f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];c.prototype.makeWidget=function(b){var c=!1;if(this.options.localeDetect){var d=navigator.language||"en-us";~d.toLowerCase().indexOf("en-us")||(c=!0)}this.options.celsius&&(c=!0);var g=b.currently,h=b.hourly.data,i=b.daily.data,j=this,k=Math.round(c?e(g.temperature):g.temperature),l=c?"C":"F",m=a("<div>").addClass("widget").addClass("weather"),n=a("<header>").addClass("title"),o=a("<a>").addClass("expand").addClass("more").attr("href","#").text("7 Day Forecast");n.append(a("<h2>").addClass("name").text("Local Weather")).append(a("<span>").addClass("description").text("Current Conditions")).append(o),j.options.showTitle&&m.append(n);var p=a("<section>").addClass("current");p.append(a("<img>").addClass("icon").attr("src",j.options.imgPath+g.icon+".svg")).append(a("<span>").addClass("temperature").html(k+"&deg;"+l)).append(a("<span>").addClass("description").text(g.summary)),m.append(p);for(var q=a("<section>").addClass("hourly"),r=a("<div>").addClass("hour").addClass("five").append(a("<span>").addClass("time")).append(a("<img>").addClass("icon")).append(a("<span>").addClass("temperature")),s=0;5>s;s++){var t=Math.round(h[s+1].temperature),u=h[s+1].icon,v=(new Date).getHours()+s,w=v>=12?"pm":"am";t=c?e(t):t,v>23&&(v=Math.abs(23-v),w="am"),v%=12,v=v?v:12;var x=r.clone();x.find(".time").text(v+w),x.find(".icon").attr("src",j.options.imgPath+u+".svg"),x.find(".temperature").html(t+"&deg;"),q.append(x)}m.append(q);var y=a("<div>").addClass("expand-wrapper").addClass("hide"),z=a("<section>").addClass("forecasts");z.append(a("<header>").addClass("forecast").append(a("<span>").addClass("day").text("7 Day Forecast")).append(a("<span>").addClass("high").text("High")).append(a("<span>").addClass("low").text("Low")));for(var A=0;7>A;A++){var B=f[new Date(1e3*i[A+1].time).getDay()],u=i[A+1].icon,C=Math.round(i[A+1].temperatureMax),D=Math.round(i[A+1].temperatureMin);C=c?e(C):C,D=c?e(D):D,z.append(a("<div>").addClass("forecast").append(a("<span>").addClass("day").text(B)).append(a("<img>").addClass("icon").attr("src",j.options.imgPath+u+".svg")).append(a("<span>").addClass("high").html(C+"&deg;")).append(a("<span>").addClass("low").html(D+"&deg;")))}y.append(z),m.append(y),o.on("click",function(a){a.preventDefault(),y.hasClass("hide")?(o.removeClass("more").addClass("less"),y.stop().slideDown().removeClass("hide")):(o.removeClass("less").addClass("more"),y.stop().slideUp().addClass("hide"))}),j.$el.append(m)},a.fn.weatherWidget=function(a){return this.each(function(){new c(this,a)})},a.extend({weatherWidget:c.prototype})}(jQuery,"undefined"!=typeof lsLite?lsLite:null);
//# sourceMappingURL=weather-widget.min.js.map